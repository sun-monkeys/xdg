<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.css.network/css?family=Lato:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Consolas:300,300italic,400,400italic,700,700italic|Iosevka:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="shell," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.0" />






<meta name="description" content="function函数1234函数function是由若干条shell命令组成的语句块，实现代码重用和模块化编程，它与shell程序形式上是相似的，不同的是它不是一个单独的进程，不能独立运行，而是shell程序的一部分 函数和shell程序比较相似，区别在于: Shell程序在子Shell中运行，属于当前脚本的子进程执行，而Shell函数在当前Shell中运行，因此在当前Shell中，  函数可以对">
<meta name="keywords" content="shell">
<meta property="og:type" content="article">
<meta property="og:title" content="shell脚本编程进阶 -2">
<meta property="og:url" content="http://yoursite.com/2018/03/25/linux/基础/shell脚本编程进阶 -2/index.html">
<meta property="og:site_name" content="Zookeeper">
<meta property="og:description" content="function函数1234函数function是由若干条shell命令组成的语句块，实现代码重用和模块化编程，它与shell程序形式上是相似的，不同的是它不是一个单独的进程，不能独立运行，而是shell程序的一部分 函数和shell程序比较相似，区别在于: Shell程序在子Shell中运行，属于当前脚本的子进程执行，而Shell函数在当前Shell中运行，因此在当前Shell中，  函数可以对">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-07-25T05:48:03.394Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="shell脚本编程进阶 -2">
<meta name="twitter:description" content="function函数1234函数function是由若干条shell命令组成的语句块，实现代码重用和模块化编程，它与shell程序形式上是相似的，不同的是它不是一个单独的进程，不能独立运行，而是shell程序的一部分 函数和shell程序比较相似，区别在于: Shell程序在子Shell中运行，属于当前脚本的子进程执行，而Shell函数在当前Shell中运行，因此在当前Shell中，  函数可以对">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/03/25/linux/基础/shell脚本编程进阶 -2/"/>





  <title> shell脚本编程进阶 -2 | Zookeeper </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?822bf9a08ff5afbcfcc481a56a6ad577";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zookeeper</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Still see you as the whole of my life</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home Page
          </a>
        </li>
      
        
        <li class="menu-item menu-item-linux1">
          <a href="/categories/LinuxBasics" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-linux"></i> <br />
            
            Linux Basics
          </a>
        </li>
      
        
        <li class="menu-item menu-item-linux2">
          <a href="/categories/LinuxServices" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-linux"></i> <br />
            
            Linux Services
          </a>
        </li>
      
        
        <li class="menu-item menu-item-python1">
          <a href="/categories/PythonBasics" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-rub"></i> <br />
            
            Python Basics
          </a>
        </li>
      
        
        <li class="menu-item menu-item-python2">
          <a href="/categories/PythonCase" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-rub"></i> <br />
            
            Python Case
          </a>
        </li>
      
        
        <li class="menu-item menu-item-question1">
          <a href="/categories/CommonQuestion" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bug"></i> <br />
            
            Common Question
          </a>
        </li>
      
        
        <li class="menu-item menu-item-question2">
          <a href="/categories/InterviewQuestion" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bug"></i> <br />
            
            Interview Question
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/03/25/linux/基础/shell脚本编程进阶 -2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="XDG">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zookeeper">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                shell脚本编程进阶 -2
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-25T00:00:00+08:00">
                2018-03-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/LinuxBasics/" itemprop="url" rel="index">
                    <span itemprop="name">LinuxBasics</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="function函数"><a href="#function函数" class="headerlink" title="function函数"></a>function函数</h1><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">函数function是由若干条<span class="built_in">shell</span>命令组成的语句块，实现代码重用和模块化编程，它与<span class="built_in">shell</span>程序形式上是相似的，不同的是它不是一个单独的进程，不能独立运行，而是<span class="built_in">shell</span>程序的一部分 </span><br><span class="line"></span><br><span class="line">函数和<span class="built_in">shell</span>程序比较相似，区别在于: <span class="built_in">Shell</span>程序在子<span class="built_in">Shell</span>中运行，属于当前脚本的子进程执行，而<span class="built_in">Shell</span>函数在当前<span class="built_in">Shell</span>中运行，因此在当前<span class="built_in">Shell</span>中，</span><br><span class="line">  函数可以对<span class="built_in">shell</span>中变量进行修改，平级来执行的，相当于当前脚本的一部分代码来执行</span><br></pre></td></tr></table></figure>
<h2 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h2><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">语法一:</span><br><span class="line">   <span class="keyword">function</span> f_name &#123;</span><br><span class="line">      <span class="keyword">...</span>函数体<span class="keyword">...</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">语法二:</span><br><span class="line">   <span class="keyword">function</span> f_name () &#123;</span><br><span class="line">      <span class="keyword">...</span>函数体<span class="keyword">...</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">语法三:</span><br><span class="line">   f_name () &#123;</span><br><span class="line">      <span class="keyword">...</span>函数体<span class="keyword">...</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数使用"><a href="#函数使用" class="headerlink" title="函数使用"></a>函数使用</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">函数的定义和使用: </span><br><span class="line">   可在交互式环境下定义函数</span><br><span class="line">   可将函数放在脚本文件中作为它的一部分</span><br><span class="line">   可放在只包含函数的单独文件中</span><br><span class="line">   调用: 函数只有被调用才会执行</span><br><span class="line">      调用: 给定函数名</span><br><span class="line">      函数名出现的地方，会被自动替换为函数代码</span><br><span class="line">   函数的生命周期: 被调用时创建，返回时终止</span><br><span class="line">   <span class="comment"># 当函数名跟别名一样的时候 --&gt; 别名的优先级要高</span></span><br><span class="line">例:</span><br><span class="line">alias <span class="keyword">cmd</span><span class="bash">=ls </span></span><br><span class="line"><span class="bash">   <span class="function"><span class="title">cmd</span></span> () &#123; hostname; &#125;</span></span><br><span class="line"><span class="bash">   <span class="comment"># 在这里声明就会出现在错误 --&gt; -bash: syntax error near unexpected token '('</span></span></span><br><span class="line"><span class="bash">   <span class="comment"># 已经把cmd当成ls () &#123; hostname; &#125; 所以会出错，这时执行 cmd 运行的是别名</span></span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">函数必须先声明再使用，会报错，变量是默认的有空值，不会报错</span></span><br></pre></td></tr></table></figure>
<h2 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h2><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">函数有两种返回值</span><br><span class="line">   函数的执行结果返回值:</span><br><span class="line">      (<span class="number">1</span>) 使用echo等命令进行输出</span><br><span class="line">      (<span class="number">2</span>) 函数体中调用命令的输出结果</span><br><span class="line"></span><br><span class="line">   函数的退出状态码:</span><br><span class="line">      (<span class="number">1</span>) 默认取决于函数中执行的最后一条命令的退出状态码</span><br><span class="line">      (<span class="number">2</span>) 自定义退出状态码，其格式为</span><br><span class="line">         <span class="keyword">return</span>    从函数中返回，用最后状态命令决定返回值</span><br><span class="line">         <span class="keyword">return</span> <span class="number">0</span>  无错误返回</span><br><span class="line">         <span class="keyword">return</span> <span class="number">1</span><span class="number">-255</span>  有错误返回</span><br></pre></td></tr></table></figure>
<h2 id="交互式环境下定义和使用函数"><a href="#交互式环境下定义和使用函数" class="headerlink" title="交互式环境下定义和使用函数"></a>交互式环境下定义和使用函数</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">例:</span><br><span class="line">   <span class="keyword">dir</span>() &#123;</span><br><span class="line">   &gt; <span class="keyword">ls</span> -<span class="keyword">l</span></span><br><span class="line">   &gt; &#125;</span><br><span class="line">定义该函数后，若在$后面键入<span class="keyword">dir</span>，其显示结果同<span class="keyword">ls</span> -<span class="keyword">l</span>的作用相同</span><br><span class="line"></span><br><span class="line">该<span class="keyword">dir</span>函数将一直保留到用户从系统退出，或执行了如下所示的</span><br><span class="line">   unset命令: unset <span class="keyword">dir</span></span><br><span class="line"></span><br><span class="line">在脚本中定义及使用函数</span><br><span class="line">   函数在使用前必须定义，因此应将函数定义放在脚本开始部分，直至<span class="keyword">shell</span>首次发现它后才能使用，调用函数仅使用其函数名即可</span><br></pre></td></tr></table></figure>
<h2 id="使用函数文件"><a href="#使用函数文件" class="headerlink" title="使用函数文件"></a>使用函数文件</h2><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">可以将经常使用的函数存入函数文件，然后将函数文件载入<span class="keyword">shell</span><span class="bash"></span></span><br><span class="line"><span class="bash">文件名可任意选取，但最好与相关任务有某种联系，例如: functions.main</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">一旦函数文件载入shell，就可以在命令行或脚本中调用函数，可以使用<span class="built_in">set</span>命令查看所有，定义的函数，其输出列表包括已经载入shell的所有函数</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">若要改动函数，首先用<span class="built_in">unset</span>命令从shell中删除函数，改动完毕后，再重新载入此文件</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">创建函数文件</span></span><br><span class="line"><span class="bash">   cat  functions.main</span></span><br><span class="line"><span class="bash">   <span class="comment">#!/bin/bash</span></span></span><br><span class="line"><span class="bash">   <span class="comment">#functions.main</span></span></span><br><span class="line"><span class="bash">   <span class="function"><span class="title">findit</span></span>() &#123;</span></span><br><span class="line"><span class="bash">      <span class="keyword">if</span> [ <span class="variable">$#</span> -lt 1 ] ;<span class="keyword">then</span></span></span><br><span class="line"><span class="bash">         <span class="built_in">echo</span> <span class="string">"Usage:findit file"</span></span></span><br><span class="line"><span class="bash">         <span class="built_in">return</span> 1</span></span><br><span class="line"><span class="bash">      <span class="keyword">fi</span></span></span><br><span class="line"><span class="bash">      find / -name <span class="variable">$1</span> –<span class="built_in">print</span></span></span><br><span class="line"><span class="bash">   &#125;</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">载入函数</span></span><br><span class="line"><span class="bash">   函数文件已创建好后，要将它载入shell</span></span><br><span class="line"><span class="bash">   <span class="comment"># 在脚本当中执行函数里功能，而脚本是开一个子进程的，无法识别父进程的函数声明</span></span></span><br><span class="line"><span class="bash">   定位函数文件并载入shell的格式:</span></span><br><span class="line"><span class="bash">      .  filename  或  <span class="built_in">source</span>  filename</span></span><br><span class="line"><span class="bash">      <span class="comment"># 此即&lt;点&gt; &lt;空格&gt; &lt;文件名&gt; 这里的文件名要带正确路径</span></span></span><br><span class="line"><span class="bash">例:</span></span><br><span class="line"><span class="bash">   上例中的函数，可使用如下命令:  . functions.main</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">检查载入函数</span></span><br><span class="line"><span class="bash">   使用<span class="built_in">set</span>命令检查函数是否已载入，<span class="built_in">set</span>命令将在shell中显示所有的载入函数 </span></span><br><span class="line"><span class="bash">   <span class="function"><span class="title">findit</span></span> () &#123;</span></span><br><span class="line"><span class="bash">      ***</span></span><br><span class="line"><span class="bash">   &#125;</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">执行shell函数</span></span><br><span class="line"><span class="bash">   要执行函数，简单地键入函数名即可</span></span><br><span class="line"><span class="bash">例:</span></span><br><span class="line"><span class="bash">   findit groups  <span class="comment"># groups 显示当前的属组</span></span></span><br><span class="line"><span class="bash">   /usr/bin/groups</span></span><br><span class="line"><span class="bash">   /usr/<span class="built_in">local</span>/backups/groups.bak</span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">删除shell函数</span></span><br><span class="line"><span class="bash">   现在对函数做一些改动后，需要先删除函数，使其对shell不可用，使用<span class="built_in">unset</span>命令完成删除函数</span></span><br><span class="line"><span class="bash">   命令格式为: <span class="built_in">unset</span> function_name</span></span><br><span class="line"><span class="bash">	</span></span><br><span class="line"><span class="bash">例:</span></span><br><span class="line"><span class="bash">   <span class="built_in">unset</span> findit</span></span><br><span class="line"><span class="bash">   再键入<span class="built_in">set</span>命令，函数将不再显示</span></span><br><span class="line"><span class="bash">   <span class="comment"># 在命令行中 输入: set 显示环境变量和函数（source 执行过了）</span></span></span><br><span class="line"><span class="bash">   <span class="comment"># 也可以只显示函数: declare -f 或 declare -f function_name  # 查看具体的某一个函数</span></span></span><br><span class="line"><span class="bash"></span></span><br><span class="line"><span class="bash">环境函数</span></span><br><span class="line"><span class="bash">   使子进程也可使用</span></span><br><span class="line"><span class="bash">   声明: <span class="built_in">export</span> –f  function_name  (函数名)  <span class="comment"># 不是函数的文件名</span></span></span><br><span class="line"><span class="bash">   查看: <span class="built_in">export</span> -f 或 <span class="built_in">declare</span> -xf</span></span><br></pre></td></tr></table></figure>
<h2 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h2><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">函数可以接受参数<span class="symbol">:</span></span><br><span class="line">   传递参数给函数: 调用函数时，在函数名后面以空白分隔，给定参数列表即可</span><br><span class="line">   例如: <span class="string">"testfunc arg1 arg2 ..."</span></span><br><span class="line"></span><br><span class="line">在函数体中当中，可使用<span class="variable">$1</span>，<span class="variable">$2</span>，... 调用这些参数，还可以使用 <span class="variable">$@</span>，<span class="variable">$*</span>，<span class="variable">$#</span> 等特殊变量</span><br></pre></td></tr></table></figure>
<h2 id="函数变量"><a href="#函数变量" class="headerlink" title="函数变量"></a>函数变量</h2><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">变量作用域</span><br><span class="line">   环境变量: 当前<span class="built_in">shell</span>和子<span class="built_in">shell</span>有效</span><br><span class="line">   本地变量: 只在当前<span class="built_in">shell</span>进程有效，为执行脚本会启动</span><br><span class="line">   专用子<span class="built_in">shell</span>进程: 因此，本地变量的作用范围是当前<span class="built_in">shell</span>脚本程序文件，包括脚本中的函数</span><br><span class="line">   局部变量: 函数的生命周期，函数结束时变量被自动销毁</span><br><span class="line"><span class="comment"># 如果函数中有局部变量，如果其名称同本地变量，使用局部变量</span></span><br><span class="line">在函数中定义局部变量的方法</span><br><span class="line">   <span class="built_in">local</span> NAME=VALUE</span><br><span class="line">   declare -i <span class="built_in">num</span>=<span class="number">100</span>   系统默认把<span class="built_in">num</span>当成局部变量了</span><br><span class="line">   declare -ig <span class="built_in">num</span>=<span class="number">100</span>  全局变量 g <span class="comment">--&gt; 全局</span></span><br></pre></td></tr></table></figure>
<h2 id="函数递归"><a href="#函数递归" class="headerlink" title="函数递归"></a>函数递归</h2><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">函数直接或间接调用自身，注意递归层数</span><br><span class="line"></span><br><span class="line">示例:</span><br><span class="line">   <span class="built-in">fact</span>.sh</span><br><span class="line">      #!/bin/bash</span><br><span class="line">      <span class="built-in">fact</span>() &#123;</span><br><span class="line">         <span class="keyword">if</span> [ <span class="symbol">$</span><span class="number">1</span> -<span class="keyword">eq</span> <span class="number">0</span> -o <span class="symbol">$</span><span class="number">1</span> -<span class="keyword">eq</span> <span class="number">1</span> ]; <span class="keyword">then</span></span><br><span class="line">            echo <span class="number">1</span></span><br><span class="line">         <span class="keyword">else</span></span><br><span class="line">         echo <span class="symbol">$</span>[<span class="symbol">$</span><span class="number">1</span>*<span class="symbol">$</span>(<span class="built-in">fact</span> <span class="symbol">$</span>[<span class="symbol">$</span><span class="number">1</span><span class="number">-1</span>])]  或者写成  <span class="symbol">$</span>[<span class="symbol">$</span><span class="number">1</span>*`<span class="built-in">fact</span> <span class="symbol">$</span>[<span class="symbol">$</span><span class="number">1</span><span class="number">-1</span>]`]</span><br><span class="line">         fi</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built-in">fact</span> <span class="symbol">$</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line">fork炸弹</span><br><span class="line">   fork炸弹是一种恶意程序，它的内部是一个不断在fork进程的无限循环，实质是一个简单的递归程序</span><br><span class="line">   由于程序是递归的，如果没有任何限制，这会导致这个简单的程序迅速耗尽系统里面的所有资源</span><br><span class="line">函数实现:</span><br><span class="line">   :()&#123; :|:&amp; &#125;;:  # 示例 <span class="number">1</span></span><br><span class="line">   bomb() &#123; bomb | bomb &amp; &#125;; bomb  # 示例 <span class="number">2</span></span><br><span class="line">   脚本实现:</span><br><span class="line">      cat Bomb.sh</span><br><span class="line">         #!/bin/bash</span><br><span class="line">         ./<span class="symbol">$</span><span class="number">0</span>|./<span class="symbol">$</span><span class="number">0</span>&amp;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">变量: 存储单个元素的内存空间</span><br><span class="line">   Shell变量一般是无类型的，但是bash Shell提供了declare和 typeset两个命令用于指定变量的类型，两个命令是等价的</span><br><span class="line">   declare [选项] 变量名</span><br><span class="line">      -<span class="ruby">r 声明或显示只读变量</span></span><br><span class="line"><span class="ruby">      -i 将变量定义为整型数</span></span><br><span class="line"><span class="ruby">      -a 将变量定义为数组</span></span><br><span class="line"><span class="ruby">      -A 将变量定义为关联数组</span></span><br><span class="line"><span class="ruby">      -f 显示已定义的所有函数名及其内容</span></span><br><span class="line"><span class="ruby">      -F 仅显示已定义的所有函数名</span></span><br><span class="line"><span class="ruby">      -x 声明或显示环境变量和函数</span></span><br><span class="line"><span class="ruby">      -l 声明变量为小写字母 declare –l var=UPPER</span></span><br><span class="line"><span class="ruby">      -u 声明变量为大写字母 declare –u var=lower</span></span><br><span class="line"><span class="ruby"></span></span><br><span class="line"><span class="ruby">数组: 存储多个元素的连续的内存空间，相当于多个变量的集合</span></span><br></pre></td></tr></table></figure>
<h2 id="数组名和索引"><a href="#数组名和索引" class="headerlink" title="数组名和索引"></a>数组名和索引</h2><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">索引: 编号从<span class="number">0</span>开始，属于数值索引</span><br><span class="line"><span class="comment"># 索引可支持使用自定义的格式，而不仅是数值格式，即为关联索引</span></span><br><span class="line">   <span class="keyword">bash4.0版本之后开始支持，查看: </span><span class="keyword">bash </span>--version</span><br><span class="line">   <span class="keyword">bash的数组支持稀疏格式（索引不连续）</span></span><br></pre></td></tr></table></figure>
<h2 id="声明数组"><a href="#声明数组" class="headerlink" title="声明数组"></a>声明数组</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">declare</span> -a ARRAY_NAME: 可以先使用，但一般还是在定义</span><br><span class="line"><span class="built_in">declare</span> -A ARRAY_NAME: 关联数组</span><br><span class="line">   关联数组: 下标不是数字，是自定义格式，必须先定义</span><br><span class="line"><span class="comment"># 两者不可相互转换</span></span><br></pre></td></tr></table></figure>
<h2 id="数组赋值"><a href="#数组赋值" class="headerlink" title="数组赋值"></a>数组赋值</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">数组元素的赋值:</span><br><span class="line">   (<span class="number">1</span>)一次只赋值一个元素</span><br><span class="line">      ARRAY_NAME[INDEX]=VALUE</span><br><span class="line">         weekdays[<span class="number">0</span>]=<span class="string">"Sunday"</span></span><br><span class="line">         weekdays[<span class="number">4</span>]=<span class="string">"Thursday"</span></span><br><span class="line">   (<span class="number">2</span>)一次赋值全部元素</span><br><span class="line">      ARRAY_NAME=(<span class="string">"VAL1"</span> <span class="string">"VAL2"</span> <span class="string">"VAL3"</span> ...)</span><br><span class="line">         <span class="built_in">name</span>=(namge wang ximing xihong)  <span class="comment"># 不加引号也可以</span></span><br><span class="line">         <span class="built_in">name</span>=(&#123;<span class="number">1.</span><span class="number">.10</span>&#125;)  <span class="comment"># 大括号可以，只能是数字，字母不行</span></span><br><span class="line">         <span class="built_in">file</span>=(/root/xdg/*.sh)  <span class="comment"># 这种也是支持的</span></span><br><span class="line">         dom=(&#123;a,b&#125;_&#123;c,d&#125;)</span><br><span class="line">   (<span class="number">3</span>)只赋值特定元素</span><br><span class="line">      ARRAY_NAME=([<span class="number">0</span>]=<span class="string">"VAL1"</span> [<span class="number">3</span>]=<span class="string">"VAL2"</span> ...)</span><br><span class="line">   (<span class="number">4</span>)交互式数组值对赋值</span><br><span class="line">      <span class="built_in">read</span> -a ARRAY</span><br><span class="line"></span><br><span class="line">显示所有数组:</span><br><span class="line">   declare  -a</span><br></pre></td></tr></table></figure>
<h2 id="引用数组"><a href="#引用数组" class="headerlink" title="引用数组"></a>引用数组</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">引用数组元素:</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;ARRAY_NAME[INDEX]&#125;</span></span><br><span class="line"><span class="meta">   #</span><span class="bash"> 省略[INDEX]表示引用下标为0的元素</span></span><br><span class="line"></span><br><span class="line">引用数组所有元素:</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;ARRAY_NAME[*]&#125;</span></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;ARRAY_NAME[@]&#125;</span></span><br><span class="line"></span><br><span class="line">数组的长度(数组中元素的个数):</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;<span class="comment">#ARRAY_NAME[*]&#125;</span></span></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;<span class="comment">#ARRAY_NAME[@]&#125;</span></span></span><br><span class="line">   sum=$[$&#123;#number[*]&#125;-1]  # number数组中元素减1</span><br><span class="line"></span><br><span class="line">删除数组中的某元素: 导致稀疏格式，稀疏--&gt;1 3 4 5 中间断开，不连续</span><br><span class="line">   unset ARRAY[INDEX]</span><br><span class="line"></span><br><span class="line">删除整个数组: unset ARRAY</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果数组是一个稀疏格式里面的元素只有 0 1 2 4 5，用<span class="variable">$&#123;#number[*]&#125;</span>查看的时候，整个元素个的还是6个</span></span><br></pre></td></tr></table></figure>
<h2 id="数组数据处理"><a href="#数组数据处理" class="headerlink" title="数组数据处理"></a>数组数据处理</h2><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">引用数组中的元素:</span><br><span class="line">   数组切片: $&#123;ARRAY<span class="string">[@]</span>:offset:number&#125;</span><br><span class="line">      offset: 要跳过的元素个数</span><br><span class="line">      number: 要取出的元素个数</span><br><span class="line">      取偏移量之后的所有元素</span><br><span class="line">         $&#123;ARRAY<span class="string">[@]</span>:offset&#125;</span><br><span class="line">例:</span><br><span class="line">   declare -a num='(<span class="string">[0]</span>=<span class="string">"1"</span> <span class="string">[1]</span>=<span class="string">"2"</span> <span class="string">[2]</span>=<span class="string">"3"</span> <span class="string">[3]</span>=<span class="string">"4"</span> <span class="string">[4]</span>=<span class="string">"5"</span> <span class="string">[5]</span>=<span class="string">"6"</span> <span class="string">[6]</span>=<span class="string">"7"</span> <span class="string">[7]</span>=<span class="string">"8"</span> <span class="string">[8]</span>=<span class="string">"9"</span>)'</span><br><span class="line">   <span class="string">[root@centos6 xdg]</span>#echo $&#123;num<span class="string">[*]</span>:<span class="number">3</span>&#125;</span><br><span class="line">   <span class="number">4</span> <span class="number">5</span> <span class="number">6</span> <span class="number">7</span> <span class="number">8</span> <span class="number">9</span></span><br><span class="line">   <span class="string">[root@centos6 xdg]</span>#echo $&#123;num<span class="string">[*]</span>:<span class="number">5</span>:<span class="number">3</span>&#125;</span><br><span class="line">   <span class="number">6</span> <span class="number">7</span> <span class="number">8</span></span><br><span class="line"></span><br><span class="line">向数组中追加元素:</span><br><span class="line">   ARRAY<span class="string">[$&#123;#ARRAY[*]</span>&#125;]=value</span><br><span class="line"></span><br><span class="line">关联数组:</span><br><span class="line">   declare -A ARRAY_NAME</span><br><span class="line">   ARRAY_NAME=(<span class="string">[idx_name1]</span>='val1' <span class="string">[idx_name2]</span>='val2‘...)</span><br><span class="line">   # 关联数组必须先声明再调用</span><br><span class="line">例:</span><br><span class="line">   declare -A student=(<span class="string">[name]</span>=xdg <span class="string">[age]</span>=<span class="number">24</span> <span class="string">[sex]</span>=man)</span><br><span class="line">   或  declare -A student</span><br><span class="line">   student=(<span class="string">[name]</span>=xdg <span class="string">[age]</span>=<span class="number">24</span> <span class="string">[sex]</span>=man)</span><br><span class="line">   # 必须要要先声明</span><br><span class="line">   # 查看 declare -A</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="字符串处理"><a href="#字符串处理" class="headerlink" title="字符串处理"></a>字符串处理</h1><h2 id="字符串字符串切片"><a href="#字符串字符串切片" class="headerlink" title="字符串字符串切片"></a>字符串字符串切片</h2><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">   $&#123;<span class="comment">#var&#125;: 返回字符串变量var的长度</span></span><br><span class="line">例:</span><br><span class="line">   var=abcdefg</span><br><span class="line">   [root@ xdg]<span class="comment">#echo $&#123;#var&#125;</span></span><br><span class="line">   <span class="number">7</span></span><br><span class="line"></span><br><span class="line">   $&#123;var:<span class="built_in">offset</span>&#125;: 返回字符串变量var中从第<span class="built_in">offset</span>个字符后不包括第<span class="built_in">offset</span>个字符的字符开始，到最后的部分，<span class="built_in">offset</span>的取值在<span class="number">0</span> 到 $&#123;<span class="comment">#var&#125;-1 之间（bash4.2后，允许为负值）</span></span><br><span class="line">   [root@ xdg]<span class="comment">#echo $&#123;var:3&#125;</span></span><br><span class="line">   defg</span><br><span class="line"></span><br><span class="line">   $&#123;var:<span class="built_in">offset</span>:<span class="built_in">number</span>&#125;: 返回字符串变量var中从第<span class="built_in">offset</span>个字符后不包括第<span class="built_in">offset</span>个字符的字符开始，长度为<span class="built_in">number</span>的部分</span><br><span class="line">   [root@ xdg]<span class="comment">#echo $&#123;var:3:2&#125;</span></span><br><span class="line">   de</span><br><span class="line"></span><br><span class="line">   $&#123;var: -<span class="built_in">length</span>&#125;: 取字符串的最右侧几个字符  <span class="comment"># 冒号后必须有一空白字符</span></span><br><span class="line">   [root@ xdg]<span class="comment">#echo $&#123;var: -3&#125;</span></span><br><span class="line">   efg	</span><br><span class="line"></span><br><span class="line">   $&#123;var:<span class="built_in">offset</span>:-<span class="built_in">length</span>&#125;: 从最左侧跳过<span class="built_in">offset</span>字符，一直向右取到距离最右侧lengh个字符之前的内容</span><br><span class="line">   [root@ ~]<span class="comment">#echo $&#123;var:4: -2&#125;  # bash在4.2.*以上才会支持，bash --versions查看</span></span><br><span class="line">   e</span><br><span class="line"></span><br><span class="line">   $&#123;var: -<span class="built_in">length</span>:-<span class="built_in">offset</span>&#125;: 先从最右侧向左取到<span class="built_in">length</span>个字符开始，再向右取到距离最右侧<span class="built_in">offset</span>个字符之间的内容</span><br><span class="line">   <span class="comment"># -length前空格</span></span><br><span class="line">   [root@ ~]<span class="comment">#echo $&#123;var: -5:3&#125;</span></span><br><span class="line">   cde</span><br><span class="line">   [root@ ~]<span class="comment">#echo $&#123;var: -5:-2&#125;  # bash在4.2.*以上才会支持，bash --versions查看</span></span><br><span class="line">   cde</span><br></pre></td></tr></table></figure>
<h2 id="字符串处理-1"><a href="#字符串处理-1" class="headerlink" title="字符串处理"></a>字符串处理</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">基于模式取子串</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;var<span class="comment">#*word&#125;: 其中word可以是指定的任意字符</span></span></span><br><span class="line">      功能: 自左而右，查找var变量所存储的字符串中，第一次出现的word，删除字符串开头至第一次出现word字符之间的所有字符</span><br><span class="line"></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;var<span class="comment">##*word&#125;: 同上，贪婪模式，不同的是，删除的是字符串开头至最后一次由word指定的字符之间的所有内容</span></span></span><br><span class="line">例: </span><br><span class="line">   file="var/log/messages"</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;file<span class="comment">#*/&#125; --&gt; log/messages</span></span></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;file<span class="comment">##*/&#125; --&gt; messages</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;var%word*&#125;: 其中word可以是指定的任意字符</span></span><br><span class="line">      功能: 自右而左，查找var变量所存储的字符串中，第一次出现的word，删除字符串最后一个字符向左至第一次出现 word字符之间的所有字符</span><br><span class="line">例:</span><br><span class="line">   file="/var/log/messages"</span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;file%/*&#125; --&gt; /var/<span class="built_in">log</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;var%%word*&#125;: 同上，只不过删除字符串最右侧的字符向左至最后一次出现word字符之间的所有字符</span></span><br><span class="line">例:</span><br><span class="line">   url=http://www.magedu.com:80 </span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;url<span class="comment">##*:&#125; --&gt; 80</span></span></span><br><span class="line"><span class="meta">   $</span><span class="bash">&#123;url%%:*&#125; --&gt; http</span></span><br></pre></td></tr></table></figure>
<h2 id="查找替换"><a href="#查找替换" class="headerlink" title="查找替换"></a>查找替换</h2><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$&#123;var<span class="meta-keyword">/pattern/</span>substr&#125;: 查找var所表示的字符串中，第一次被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">例:</span><br><span class="line">   [root@ ~]<span class="meta">#echo $aa</span></span><br><span class="line">   <span class="meta-keyword">/app/</span>httpd22/bin:<span class="meta-keyword">/usr/</span>local/sbin:<span class="meta-keyword">/usr/</span>local/bin:/sbin:/bin:<span class="meta-keyword">/usr/</span>sbin:<span class="meta-keyword">/usr/</span>bin:<span class="meta-keyword">/root/</span>bin</span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;aa/local/xxx&#125;</span></span><br><span class="line">   <span class="meta-keyword">/app/</span>httpd22/bin:<span class="meta-keyword">/usr/</span>xxx/sbin:<span class="meta-keyword">/usr/</span>local/bin:/sbin:/bin:<span class="meta-keyword">/usr/</span>sbin:<span class="meta-keyword">/usr/</span>bin:<span class="meta-keyword">/root/</span>bin</span><br><span class="line"></span><br><span class="line">   $&#123;var<span class="comment">//pattern/substr&#125;: 查找var所表示的字符串中，所有能被pattern所匹配到的字符串，以substr替换之</span></span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;aa<span class="comment">//local/xxx&#125;</span></span></span><br><span class="line">   <span class="meta-keyword">/app/</span>httpd22/bin:<span class="meta-keyword">/usr/</span>xxx/sbin:<span class="meta-keyword">/usr/</span>xxx/bin:/sbin:/bin:<span class="meta-keyword">/usr/</span>sbin:<span class="meta-keyword">/usr/</span>bin:<span class="meta-keyword">/root/</span>bin</span><br><span class="line"></span><br><span class="line">   $&#123;var/<span class="meta">#pattern/substr&#125;: 查找var所表示的字符串中，行首被pattern所匹配到的字符串，以substr替换之</span></span><br><span class="line">   [root@ ~]<span class="meta">#bb=http:<span class="comment">//www.baidu.com:8080</span></span></span><br><span class="line">   [root@ ~]<span class="meta">#echo $bb</span></span><br><span class="line"><span class="symbol">   http:</span><span class="comment">//www.baidu.com:8080</span></span><br><span class="line"></span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;bb/#htt/ftp&#125;</span></span><br><span class="line"><span class="symbol">   ftpp:</span><span class="comment">//www.baidu.com:8080  # 必须要写完整，否则匹配不对</span></span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;bb/#http/ftp&#125;</span></span><br><span class="line"><span class="symbol">   ftp:</span><span class="comment">//www.baidu.com:8080</span></span><br><span class="line"></span><br><span class="line">   $&#123;var/%pattern/substr&#125;: 查找var所表示的字符串中，行尾被pattern所匹配到的字符串，以substr替换之</span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;bb/%80/23&#125;</span></span><br><span class="line"><span class="symbol">   http:</span><span class="comment">//www.baidu.com:8023</span></span><br><span class="line">   [root@ ~]<span class="meta">#echo $&#123;bb/%8080/23&#125;</span></span><br><span class="line"><span class="symbol">   http:</span><span class="comment">//www.baidu.com:23</span></span><br></pre></td></tr></table></figure>
<h2 id="查找并删除"><a href="#查找并删除" class="headerlink" title="查找并删除"></a>查找并删除</h2><figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$&#123;<span class="keyword">var</span>/pattern&#125;: 删除<span class="keyword">var</span>所表示的字符串中第一次被pattern所匹配到的字符串</span><br><span class="line"></span><br><span class="line">$&#123;<span class="keyword">var</span><span class="comment">//pattern&#125;: 删除var所表示的字符串中所有被pattern所匹配到的字符串</span></span><br><span class="line"></span><br><span class="line">$&#123;<span class="keyword">var</span>/<span class="meta">#pattern&#125;: 删除var所表示的字符串中所有以pattern为行首所匹配到的字符串</span></span><br><span class="line"></span><br><span class="line">$&#123;<span class="keyword">var</span>/%pattern&#125;: 删除<span class="keyword">var</span>所表示的字符串中所有以pattern为行尾所匹配到的字符串</span><br><span class="line">   [<span class="meta">root@ ~</span>]<span class="meta">#echo $&#123;bb/%80&#125;</span></span><br><span class="line">   http:<span class="comment">//www.baidu.com:80  # 也只是删除第一个</span></span><br></pre></td></tr></table></figure>
<h2 id="字符大小写转换"><a href="#字符大小写转换" class="headerlink" title="字符大小写转换"></a>字符大小写转换</h2><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;<span class="keyword">var</span>^^&#125;: 把<span class="keyword">var</span>中的所有小写字母转换为大写，不管大写和小写，都转化成大写</span><br><span class="line">$&#123;<span class="keyword">var</span>,,&#125;: 把<span class="keyword">var</span>中的所有大写字母转换为小写，不管大写和小写，都转化成小写</span><br></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/shell/" rel="tag"># shell</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/23/linux/基础/shell脚本编程进阶 -1/" rel="next" title="shell脚本编程进阶 -1">
                <i class="fa fa-chevron-left"></i> shell脚本编程进阶 -1
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/26/linux/基础/shell脚本编程进阶 -3/" rel="prev" title="shell脚本编程进阶 -3">
                shell脚本编程进阶 -3 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="XDG" />
          <p class="site-author-name" itemprop="name">XDG</p>
           
              <p class="site-description motion-element" itemprop="description">Personal Blog</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">97</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">93</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sun-monkeys/xdg/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/xddggg" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#function函数"><span class="nav-number">1.</span> <span class="nav-text">function函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#定义函数"><span class="nav-number">1.1.</span> <span class="nav-text">定义函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数使用"><span class="nav-number">1.2.</span> <span class="nav-text">函数使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数返回值"><span class="nav-number">1.3.</span> <span class="nav-text">函数返回值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#交互式环境下定义和使用函数"><span class="nav-number">1.4.</span> <span class="nav-text">交互式环境下定义和使用函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用函数文件"><span class="nav-number">1.5.</span> <span class="nav-text">使用函数文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数参数"><span class="nav-number">1.6.</span> <span class="nav-text">函数参数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数变量"><span class="nav-number">1.7.</span> <span class="nav-text">函数变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#函数递归"><span class="nav-number">1.8.</span> <span class="nav-text">函数递归</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#数组"><span class="nav-number">2.</span> <span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#数组名和索引"><span class="nav-number">2.1.</span> <span class="nav-text">数组名和索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#声明数组"><span class="nav-number">2.2.</span> <span class="nav-text">声明数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组赋值"><span class="nav-number">2.3.</span> <span class="nav-text">数组赋值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#引用数组"><span class="nav-number">2.4.</span> <span class="nav-text">引用数组</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数组数据处理"><span class="nav-number">2.5.</span> <span class="nav-text">数组数据处理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#字符串处理"><span class="nav-number">3.</span> <span class="nav-text">字符串处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串字符串切片"><span class="nav-number">3.1.</span> <span class="nav-text">字符串字符串切片</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串处理-1"><span class="nav-number">3.2.</span> <span class="nav-text">字符串处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查找替换"><span class="nav-number">3.3.</span> <span class="nav-text">查找替换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#查找并删除"><span class="nav-number">3.4.</span> <span class="nav-text">查找并删除</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符大小写转换"><span class="nav-number">3.5.</span> <span class="nav-text">字符大小写转换</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XDG</span>
</div>


<div class="powered-by">
   心有猛虎
</div>

<div class="theme-info">
  细嗅蔷薇
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  





  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
