<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="DNS,Bind," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.png?v=5.1.0" />






<meta name="description" content="DNS服务12345678910111213141516DNS:Domain Name Service 应用层协议   C/S 结构模式   53/udp: 客户端查询功能   53/tcp: 主从复制功能BIND：Bekerley Internat Name Domain   ISC （www.isc.org）	本地名称解析配置文件: hosts    /etc/hosts    %WINDIR">
<meta name="keywords" content="DNS,Bind">
<meta property="og:type" content="article">
<meta property="og:title" content="DNS基础理论">
<meta property="og:url" content="http://yoursite.com/2018/04/11/linux/服务/dns/DNS基础理论/index.html">
<meta property="og:site_name" content="Zookeeper">
<meta property="og:description" content="DNS服务12345678910111213141516DNS:Domain Name Service 应用层协议   C/S 结构模式   53/udp: 客户端查询功能   53/tcp: 主从复制功能BIND：Bekerley Internat Name Domain   ISC （www.isc.org）	本地名称解析配置文件: hosts    /etc/hosts    %WINDIR">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2018-04-21T06:34:33.037Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="DNS基础理论">
<meta name="twitter:description" content="DNS服务12345678910111213141516DNS:Domain Name Service 应用层协议   C/S 结构模式   53/udp: 客户端查询功能   53/tcp: 主从复制功能BIND：Bekerley Internat Name Domain   ISC （www.isc.org）	本地名称解析配置文件: hosts    /etc/hosts    %WINDIR">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/04/11/linux/服务/dns/DNS基础理论/"/>





  <title> DNS基础理论 | Zookeeper </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?822bf9a08ff5afbcfcc481a56a6ad577";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Zookeeper</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Still see you as the whole of my life</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-linux">
          <a href="/categories/Linux" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-linux"></i> <br />
            
            Linux
          </a>
        </li>
      
        
        <li class="menu-item menu-item-python">
          <a href="/categories/Python" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-rub"></i> <br />
            
            Python
          </a>
        </li>
      
        
        <li class="menu-item menu-item-question">
          <a href="/categories/Question" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-bug"></i> <br />
            
            Question
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/11/linux/服务/dns/DNS基础理论/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="XDG">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zookeeper">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                DNS基础理论
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-11T00:00:00+08:00">
                2018-04-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="DNS服务"><a href="#DNS服务" class="headerlink" title="DNS服务"></a>DNS服务</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">DNS:Domain Name<span class="built_in"> Service </span>应用层协议</span><br><span class="line">   C/S 结构模式</span><br><span class="line">   53/udp: 客户端查询功能</span><br><span class="line">   53/tcp: 主从复制功能</span><br><span class="line"></span><br><span class="line">BIND：Bekerley Internat Name Domain</span><br><span class="line">   ISC （www.isc.org）</span><br><span class="line">	</span><br><span class="line">本地名称解析配置文件: hosts </span><br><span class="line">   /etc/hosts </span><br><span class="line">   %WINDIR%/system32/drivers/etc/hosts </span><br><span class="line">      127.0.0.1  localhost</span><br><span class="line"></span><br><span class="line">例:</span><br><span class="line">   iptables -A INPUT -p udp --dprot 53 -j REJECT  # 设置防火墙来自udp53号端口信息</span><br><span class="line">   iptables -A INPUT -p tcp --dprot 53 -j REJECT  # 设置防火墙来自tcp53号端口信息</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="DNS域名"><a href="#DNS域名" class="headerlink" title="DNS域名"></a>DNS域名</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">根域</span><br><span class="line"></span><br><span class="line">一级域名: Top Level Domain: tld com, edu, mil, gov, net, org, int, arpa等</span><br><span class="line">   三类: 组织域、国家域(<span class="selector-class">.cn</span>, <span class="selector-class">.ca</span>, <span class="selector-class">.hk</span>, .tw)、反向域</span><br><span class="line"></span><br><span class="line">二级域名</span><br><span class="line"></span><br><span class="line">三级域名</span><br><span class="line"></span><br><span class="line">最多<span class="number">127</span>级域名</span><br><span class="line"></span><br><span class="line">ICANN（The Internet Corporation <span class="keyword">for</span> Assigned Names and Numbers）</span><br><span class="line">  互联网名称与数字地址分配机构，负责在全球范围内对互联网通用顶级域名（gTLD）</span><br><span class="line">  以及国家和地区顶级域名（ccTLD）系统的管理、以及根服务器系统的管理</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="DNS解析"><a href="#DNS解析" class="headerlink" title="DNS解析"></a>DNS解析</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DNS查询类型</span><br><span class="line">   递归查询</span><br><span class="line">   迭代查询</span><br><span class="line"></span><br><span class="line">名称服务器: 域内负责解析本域内的名称的主机</span><br><span class="line">   根服务器: 13组服务器</span><br><span class="line"></span><br><span class="line">解析类型:</span><br><span class="line">   FQDN --&gt; IP</span><br><span class="line">  <span class="built_in"> IP </span>--&gt; FQDN</span><br><span class="line">   注: 正反向解析是两个不同的名称空间，是两棵不同的解析树</span><br></pre></td></tr></table></figure>
<h2 id="一次完整的查询请求经过的流程"><a href="#一次完整的查询请求经过的流程" class="headerlink" title="一次完整的查询请求经过的流程"></a>一次完整的查询请求经过的流程</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Client --&gt; hosts文件 --&gt;<span class="built_in"> DNS Service </span>Local Cache --&gt;<span class="built_in"> DNS Server </span>(recursion)</span><br><span class="line">  --&gt;<span class="built_in"> Server </span>Cache --&gt; iteration(迭代) --&gt; 根 --&gt; 顶级域名DNS --&gt; 二级域名DNS <span class="built_in">..</span>.</span><br><span class="line">注:</span><br><span class="line">   Windows客户端: 默认是有缓存的</span><br><span class="line">   Linux客户端: 默认是没有缓存的</span><br><span class="line"></span><br><span class="line">解析答案:</span><br><span class="line">   肯定答案:</span><br><span class="line">   否定答案: 请求的条目不存在等原因导致无法返回结果</span><br><span class="line">   权威答案: dig查看的状态标志位 aa</span><br><span class="line">   非权威答案:</span><br></pre></td></tr></table></figure>
<h2 id="反向区域"><a href="#反向区域" class="headerlink" title="反向区域"></a>反向区域</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">区域名称: /etc/named.rfc1912.zones  # 文件中编辑</span><br><span class="line">   网络地址反写 .in-addr.arpa. 172.16.100. --&gt; 100.16.172.in-addr.arpa.</span><br><span class="line">   # 172.16.100是网络地址</span><br><span class="line">   (1)定义区域</span><br><span class="line">      zone <span class="string">"ZONE_NAME"</span> <span class="keyword">IN</span> &#123;</span><br><span class="line">        <span class="built_in"> type </span>&#123;master|slave|forward&#125;;</span><br><span class="line">         file <span class="string">"网络地址.zone"</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">   (2)定义区域解析库文件</span><br><span class="line">      注: 不需要MX，以PTR记录为主</span><br><span class="line"></span><br><span class="line">注: 在反向区域中，域的后缀，必须每个都要加，默认的是加 xdg.com. 跟正向不同</span><br><span class="line"></span><br><span class="line">反向区域示例:</span><br><span class="line">   vim /var/named/172.18.zone  # 在这里使用的网络地址段是172.18.48.215/16</span><br><span class="line">      <span class="variable">$TTL</span> 1D</span><br><span class="line">      @  <span class="keyword">IN</span>  SOA  dns1.xdg.com.  admin.xdg.com.  (</span><br><span class="line">            100     ; serial</span><br><span class="line">            10H     ; refresh</span><br><span class="line">            2H      ; retry</span><br><span class="line">            5H      ; expire</span><br><span class="line">            1D )    ; minimum</span><br><span class="line">              NS   dns1.xdg.com.</span><br><span class="line">      215.48  PTR   dns1.xdg.com.</span><br><span class="line">      225.48  PTR   websrv.xdg.com.</span><br><span class="line"></span><br><span class="line">注: 在前面的ip主机地址，也要反着写才可以，必须每个都要写域名，</span><br><span class="line">  不然全都指定成 18.172.in-addr.arpa 这个名字了</span><br><span class="line"></span><br><span class="line">   vim  /etc/named.rfc1912.zones</span><br><span class="line">      zone <span class="string">"xdg.com"</span> <span class="keyword">IN</span> &#123;</span><br><span class="line">        <span class="built_in"> type </span>master;</span><br><span class="line">         file <span class="string">"xdg.com.zone"</span>;</span><br><span class="line">      &#125;;</span><br><span class="line">      zone <span class="string">"18.172.in-addr.arpa"</span> <span class="keyword">IN</span> &#123;</span><br><span class="line">        <span class="built_in"> type </span>master;</span><br><span class="line">         file <span class="string">"172.18.zone"</span>;</span><br><span class="line">      &#125;;</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="DNS服务器类型"><a href="#DNS服务器类型" class="headerlink" title="DNS服务器类型"></a>DNS服务器类型</h1><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DNS服务器的类型</span><br><span class="line">   主DNS服务器</span><br><span class="line">   从DNS服务器</span><br><span class="line">   缓存DNS服务器（转发器）</span><br><span class="line"></span><br><span class="line"><span class="section">主DNS服务器: 管理和维护所负责解析的域内解析库的服务器</span></span><br><span class="line"><span class="section">从DNS服务器: 从主服务器或从服务器"复制"（区域传输）解析库副本</span></span><br><span class="line"></span><br><span class="line">   序列号: 解析库版本号，主服务器解析库变化时，其序列递增</span><br><span class="line">   刷新时间间隔: 从服务器从主服务器请求同步解析的时间间隔</span><br><span class="line">   重试时间间隔: 从服务器请求同步失败时，再次尝试时间间隔</span><br><span class="line">   过期时长: 从服务器联系不到主服务器时，多久后停止服务</span><br><span class="line"></span><br><span class="line"><span class="string">"通知"</span>机制: 主服务器解析库发生变化时，会主动通知从服务器</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="区域传输"><a href="#区域传输" class="headerlink" title="区域传输"></a>区域传输</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">区域传输</span><br><span class="line">   完全传输: 传送整个解析库 </span><br><span class="line">   增量传输: 传递解析库变化的那部分内容</span><br><span class="line"></span><br><span class="line">Domain: Fully Qualified Domain Name </span><br><span class="line">   正向: FQDN --&gt; IP</span><br><span class="line">   反向:<span class="built_in"> IP </span>--&gt; FQDN</span><br><span class="line"></span><br><span class="line">负责本地域名的正向和反向解析库</span><br><span class="line">   正向区域</span><br><span class="line">   反向区域</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="资源记录"><a href="#资源记录" class="headerlink" title="资源记录"></a>资源记录</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">区域解析库: 由众多RR组成</span><br><span class="line">   资源记录:<span class="built_in"> Resource </span>Record, RR</span><br><span class="line">   记录类型: A, AAAA, PTR, SOA, NS, CNAME, MX</span><br><span class="line"></span><br><span class="line">SOA: Start Of Authority，起始授权记录，一个区域解析库有且仅能有一个SOA记录，</span><br><span class="line">  必须位于解析库的第一条记录 </span><br><span class="line"></span><br><span class="line">A: internet<span class="built_in"> Address </span> # 作用 FQDN --&gt; IP</span><br><span class="line">   注: 如果有两个web服务器的A记录</span><br><span class="line">      windows: 因为有缓存的原因，所以会一直访问A，不会访问B</span><br><span class="line">      linux: 客户端是没有缓存功能的原因，请求的时候轮询的方式 A-B-A-B 的方式</span><br><span class="line"></span><br><span class="line">AAAA: FQDN --&gt; IPv6</span><br><span class="line"></span><br><span class="line">PTR: PoinTeR，IP --&gt; FQDN</span><br><span class="line"></span><br><span class="line">NS: Name<span class="built_in"> Server </span> # 专用于标明当前区域的DNS服务器</span><br><span class="line"></span><br><span class="line">CNAME: Canonical Name  # 别名记录</span><br><span class="line"></span><br><span class="line">MX: Mail eXchanger  # 邮件交换器</span><br><span class="line"></span><br><span class="line">资源记录定义的格式: 可简写成</span><br><span class="line">   语法: name  [TTL]  <span class="keyword">IN</span>  rr_type  value</span><br><span class="line">注:</span><br><span class="line">   (1) TTL可从全局继承</span><br><span class="line">   (2) @可用于引用当前区域的名字</span><br><span class="line">   (3) 同一个名字可以通过多条记录定义多个不同的值，此时DNS服务器会以轮询方式响应</span><br><span class="line">   (4) 同一个值也可能有多个不同的定义名字，通过多个不同的名字指向同一个值进行定义</span><br><span class="line">     此仅表示通过多个不同的名字可以找到同一个主机</span><br></pre></td></tr></table></figure>
<h2 id="SOA记录"><a href="#SOA记录" class="headerlink" title="SOA记录"></a>SOA记录</h2><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">name:</span> 当前区域的名字，如: <span class="string">"xdg.com."</span></span><br><span class="line"><span class="symbol">value:</span> 有多部分组成</span><br><span class="line">   (<span class="number">1</span>) 当前区域的主DNS服务器的FQDN，也可以使用当前区域的名字</span><br><span class="line">   (<span class="number">2</span>) 当前区域管理员的邮箱地址，但地址中不能使用@符号，一般用.替换，如linux.xdg.com</span><br><span class="line">   (<span class="number">3</span>) 主从服务区域传输相关定义以及否定的答案的统一的TTL</span><br><span class="line">例:</span><br><span class="line">   xdg.com.  <span class="number">86400</span>  IN  SOA  dns1.xdg.com.   xdg.xdg.com. (</span><br><span class="line">      <span class="number">2015042201</span> ;序列号</span><br><span class="line">      <span class="meta"># 修改后不更改，后面的从DNS则无法获取，认为跟原来的一样，没有更新操作</span></span><br><span class="line">      <span class="number">2</span>H         ;刷新时间  <span class="meta"># 从服务器会从主服务器中获取新数据的间隔时间</span></span><br><span class="line">      <span class="number">10</span>M        ;重试时间  <span class="meta"># 从服务器的重试</span></span><br><span class="line">      <span class="number">1</span>W         ;过期时间  <span class="meta"># 从服务器则无法使用</span></span><br><span class="line">      <span class="number">1</span>D         ;否定答案的TTL值  <span class="meta"># 是指用户查询失败的记录的缓存有效期</span></span><br><span class="line">   )</span><br><span class="line">例: 输入wwwww.xdg.com 查询是没有(失败)，也会缓存在服务器中，</span><br><span class="line">  下次用户查询的时候，会返回失败</span><br><span class="line"></span><br><span class="line">注: </span><br><span class="line">$TTL  <span class="meta"># 缓存有效期</span></span><br><span class="line"></span><br><span class="line">dns1.xdg.com.  <span class="meta"># 最后必须要有点</span></span><br><span class="line">   dns1  <span class="meta"># 或者写成这样</span></span><br><span class="line">   下面必须要有对应的A记录（后期可能有多个，但是只有一个master）</span><br><span class="line"></span><br><span class="line">xdg.xdg.com.  <span class="meta"># 这是一个邮箱地址，其实是xdg@xdg.com.</span></span><br><span class="line">   xdg  <span class="meta"># 或者写成这样</span></span><br><span class="line"></span><br><span class="line">主DNS  <span class="meta"># 可读可写</span></span><br><span class="line">从DNS  <span class="meta"># 只能查询，是从主的那里复制过来的 --&gt; 单向复制</span></span><br><span class="line"></span><br><span class="line">如何发生改变</span><br><span class="line"><span class="symbol">   push:</span> 推  <span class="meta"># 主的主动去发送数据到从服务，如果传送数据过程中发生中断</span></span><br><span class="line"><span class="symbol">   pull:</span> 拉  <span class="meta"># 从的会隔一定时间从主那里获取新的数据（新: 以序列号为准）</span></span><br></pre></td></tr></table></figure>
<h2 id="NS记录"><a href="#NS记录" class="headerlink" title="NS记录"></a>NS记录</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">name: 当前区域的名字</span><br><span class="line">value: 当前区域的某DNS服务器的名字，例: ns<span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">注: 一个区域可以有多个NS记录</span><br><span class="line">例:</span><br><span class="line">   xdg<span class="selector-class">.com</span>.  IN   NS  ns1<span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   xdg<span class="selector-class">.com</span>.  IN   NS  ns2<span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   注: 如果上面指定的是同样的可以用 @ 来代替</span><br><span class="line">注:</span><br><span class="line">   (<span class="number">1</span>) 相邻的两个资源记录的name相同时，后续的可省略</span><br><span class="line">   (<span class="number">2</span>) 对NS记录而言，任何一个ns记录后面的服务器名字，都应该在后续有一个A记录</span><br></pre></td></tr></table></figure>
<h2 id="MX记录"><a href="#MX记录" class="headerlink" title="MX记录"></a>MX记录</h2><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">name: 当前区域的名字</span><br><span class="line">value: 当前区域的某邮件服务器( smtp服务器 )的主机名</span><br><span class="line">一个区域内，<span class="keyword">MX</span>记录可有多个，但每个记录的value之前应该有一个数字( <span class="number">0</span>-<span class="number">99</span> )，</span><br><span class="line">  表示此服务器的优先级，数字越小，优先级越高</span><br><span class="line">例:</span><br><span class="line">   xdg.com.   <span class="keyword">IN</span>    <span class="keyword">MX</span>   <span class="number">10</span>  mx1.xdg.com.</span><br><span class="line">              <span class="keyword">IN</span>    <span class="keyword">MX</span>   <span class="number">20</span>  mx2.xdg.com.</span><br><span class="line">注:</span><br><span class="line">   (<span class="number">1</span>) 对<span class="keyword">MX</span>记录而言，任何一个<span class="keyword">MX</span>记录后面的服务器名字，都应该在后续有一个<span class="keyword">A</span>记录</span><br></pre></td></tr></table></figure>
<h2 id="A记录"><a href="#A记录" class="headerlink" title="A记录"></a>A记录</h2><figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">name: 某主机的FQDN，例如www.xdg.com.</span><br><span class="line">value: 主机名对应主机的IP地址</span><br><span class="line">例:</span><br><span class="line">www.xdg.com. <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">1.1.1.1</span></span><br><span class="line">www.xdg.com. <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">2.2.2.2</span></span><br><span class="line">mx1.xdg.com. <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">3.3.3.3</span></span><br><span class="line">mx2.xdg.com. <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">4.4.4.4</span></span><br><span class="line">xdg.com.     <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">6.6.6.6</span></span><br><span class="line"><span class="meta">$GENERATE</span>    <span class="number">1</span>-<span class="number">254</span> HOST$  <span class="keyword">A</span>  <span class="number">1</span>.<span class="number">2</span>.<span class="number">3</span>.$</span><br><span class="line">   注: $GENERATE ( 关键字: generate )</span><br><span class="line">   例: $GENERATE  <span class="number">1</span>-<span class="number">100</span>  xdg$  <span class="keyword">A</span>  <span class="number">172.18.48</span>.$  # 表示<span class="number">1</span>-<span class="number">100</span></span><br><span class="line">      xdg1    <span class="keyword">A</span>  <span class="number">172.18.48.1</span></span><br><span class="line">      ......</span><br><span class="line">      xdg100  <span class="keyword">A</span>  <span class="number">172.18.48.100</span></span><br><span class="line">*.xdg.com.   <span class="keyword">IN</span>  <span class="keyword">A</span> <span class="number">5.5.5.5</span></span><br><span class="line">   注: 泛域名的解析  如: 输入 wwwwww.xdg.com 还是能访问</span><br><span class="line"></span><br><span class="line">避免用户写错名称时给错误答案，可通过泛域名解析进行解析至某特定地址</span><br></pre></td></tr></table></figure>
<h2 id="其它记录"><a href="#其它记录" class="headerlink" title="其它记录"></a>其它记录</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">AAAA</span>:</span><br><span class="line">   <span class="selector-tag">name</span>: <span class="selector-tag">FQDN</span></span><br><span class="line">   <span class="selector-tag">value</span>: <span class="selector-tag">IPv6</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">PTR</span>:</span><br><span class="line">   <span class="selector-tag">name</span>: <span class="selector-tag">IP</span>，有特定格式，把<span class="selector-tag">IP</span>地址反过来写，1<span class="selector-class">.2</span><span class="selector-class">.3</span><span class="selector-class">.4</span>，要写作4<span class="selector-class">.3</span><span class="selector-class">.2</span><span class="selector-class">.1</span>，</span><br><span class="line">     而有特定后缀<span class="selector-pseudo">:in-addr.arpa.</span>，所以完整写法为: 4<span class="selector-class">.3</span><span class="selector-class">.2</span><span class="selector-class">.1</span><span class="selector-class">.in-addr</span><span class="selector-class">.arpa</span>.</span><br><span class="line">   <span class="selector-tag">value</span>: <span class="selector-tag">FQDN</span></span><br><span class="line">例:</span><br><span class="line">   4<span class="selector-class">.3</span><span class="selector-class">.2</span><span class="selector-class">.1</span><span class="selector-class">.in-addr</span><span class="selector-class">.arpa</span>.  <span class="selector-tag">IN</span>   <span class="selector-tag">PTR</span>   <span class="selector-tag">www</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   如: 1<span class="selector-class">.2</span><span class="selector-class">.3</span>为网络地址，可简写成: 4  <span class="selector-tag">IN</span>  <span class="selector-tag">PTR</span> <span class="selector-tag">www</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   注: 网络地址及后缀可省略，主机地址依然需要反着写</span><br></pre></td></tr></table></figure>
<h2 id="别名记录"><a href="#别名记录" class="headerlink" title="别名记录"></a>别名记录</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CNAME:</span><br><span class="line">   name: 别名的FQDN </span><br><span class="line">   value: 真正名字的FQDN </span><br><span class="line">例:</span><br><span class="line">   www<span class="selector-class">.xdg</span><span class="selector-class">.com</span>.  IN  CNAME  websrv<span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br></pre></td></tr></table></figure>
<h2 id="子域"><a href="#子域" class="headerlink" title="子域"></a>子域</h2><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">子域授权: 每个域的名称服务器，都是通过其上级名称服务器在解析库进行授权</span><br><span class="line"></span><br><span class="line">类似根域授权<span class="selector-tag">tld</span>:</span><br><span class="line">   <span class="selector-class">.com</span>.     <span class="selector-tag">IN</span>   <span class="selector-tag">NS</span>  <span class="selector-tag">ns1</span><span class="selector-class">.com</span>.</span><br><span class="line">   <span class="selector-class">.com</span>.     <span class="selector-tag">IN</span>   <span class="selector-tag">NS</span>  <span class="selector-tag">ns2</span><span class="selector-class">.com</span>.</span><br><span class="line">   <span class="selector-tag">ns1</span><span class="selector-class">.com</span>.  <span class="selector-tag">IN</span>   <span class="selector-tag">A</span>   2<span class="selector-class">.2</span><span class="selector-class">.2</span><span class="selector-class">.1</span></span><br><span class="line">   <span class="selector-tag">ns2</span><span class="selector-class">.com</span>.  <span class="selector-tag">IN</span>   <span class="selector-tag">A</span>   2<span class="selector-class">.2</span><span class="selector-class">.2</span><span class="selector-class">.2</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">xdg</span><span class="selector-class">.com</span>. 在<span class="selector-class">.com</span>的名称服务器上，解析库中添加资源记录</span><br><span class="line">   <span class="selector-tag">xdg</span><span class="selector-class">.com</span>.      <span class="selector-tag">IN</span>  <span class="selector-tag">NS</span> <span class="selector-tag">ns1</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   <span class="selector-tag">xdg</span><span class="selector-class">.com</span>.      <span class="selector-tag">IN</span>  <span class="selector-tag">NS</span> <span class="selector-tag">ns2</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.</span><br><span class="line">   <span class="selector-tag">ns1</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.  <span class="selector-tag">IN</span>  <span class="selector-tag">A</span>  3<span class="selector-class">.3</span><span class="selector-class">.3</span><span class="selector-class">.1</span></span><br><span class="line">   <span class="selector-tag">ns2</span><span class="selector-class">.xdg</span><span class="selector-class">.com</span>.  <span class="selector-tag">IN</span>  <span class="selector-tag">A</span>  3<span class="selector-class">.3</span><span class="selector-class">.3</span><span class="selector-class">.2</span></span><br><span class="line">		</span><br><span class="line"><span class="selector-tag">glue</span> <span class="selector-tag">record</span>: 粘合记录，父域授权子域的记录</span><br></pre></td></tr></table></figure>
<h2 id="互联网域名"><a href="#互联网域名" class="headerlink" title="互联网域名"></a>互联网域名</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">域名注册</span><br><span class="line">   代理商: 万网, 新网, godaddy</span><br><span class="line"></span><br><span class="line">注册完成以后，想自己用专用服务来解析</span><br><span class="line">   管理后台: 把NS记录指向的服务器名称，和A记录指向的服务器地址</span><br><span class="line"></span><br><span class="line">CDN: Content Delivery Network</span><br><span class="line">   服务商: 蓝汛，网宿，帝联等</span><br><span class="line">   智能DNS: dnspod dns.la</span><br></pre></td></tr></table></figure>
<hr>
<h1 id="Bind"><a href="#Bind" class="headerlink" title="Bind"></a>Bind</h1><figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">BIND</span>的安装配置 </span><br><span class="line">   dns服务程序包: <span class="keyword">bind</span>，unbound</span><br><span class="line">   程序名: <span class="keyword">named</span>，unbound</span><br><span class="line">   程序包: yum list <span class="built_in">all</span> <span class="keyword">bind</span>*</span><br><span class="line">      <span class="keyword">bind</span>: 服务器</span><br><span class="line">      <span class="keyword">bind</span>-libs: 相关库</span><br><span class="line">      <span class="keyword">bind</span>-utils: 客户端</span><br><span class="line">      <span class="keyword">bind</span>-chroot: /var/<span class="keyword">named</span>/chroot/</span><br><span class="line">         注: 迁移目录，把<span class="keyword">bind</span>相关的使用文件，全部放到另一个目录当去，</span><br><span class="line">           与/etc/目录隔离开，默认安装的时候，安装在/var/<span class="keyword">named</span>/chroot/这个目录下面，</span><br><span class="line">           安装的方式是文件目录的挂载: --<span class="keyword">bind</span>参数，具体查看挂载相关应用</span><br></pre></td></tr></table></figure>
<h2 id="bind服务器"><a href="#bind服务器" class="headerlink" title="bind服务器"></a>bind服务器</h2><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">服务脚本和名称</span><br><span class="line">   /etc/rc.d/init.d/named</span><br><span class="line">   /usr/<span class="class"><span class="keyword">lib</span>/<span class="title">systemd</span>/<span class="title">system</span>/<span class="title">named</span>.<span class="title">service</span></span></span><br><span class="line"></span><br><span class="line">主配置文件</span><br><span class="line">   /etc/named.conf  <span class="comment"># 主配置文件</span></span><br><span class="line">   /etc/named.rfc1912.zones  <span class="comment"># 区域配置文件</span></span><br><span class="line">   /etc/rndc.key</span><br><span class="line"></span><br><span class="line">解析库文件</span><br><span class="line">   /var/named/ZONE_NAME.ZONE</span><br><span class="line">   /var/named/named.ca  <span class="comment"># 根的地址</span></span><br><span class="line">注:</span><br><span class="line">   (<span class="number">1</span>) 一台物理服务器可同时为多个区域提供解析</span><br><span class="line">   (<span class="number">2</span>) 必须要有根区域文件 --&gt; named.ca</span><br><span class="line">   (<span class="number">3</span>) 应该有两个（如果包括ipv6的，应该更多）实现localhost和本地回环地址的解析库</span><br><span class="line"></span><br><span class="line"><span class="symbol">rndc:</span> remote name domain controller，默认与bind安装在同一主机，且只能通过<span class="number">127.0</span>.<span class="number">0.1</span></span><br><span class="line">  连接named进程提供辅助性的管理功能，<span class="number">953</span>/tcp</span><br><span class="line">注: bind服务的运行是以named组的权限来运行程序的在编辑一些文件之后一定要看文件的权限，</span><br><span class="line">  不然可能无法运行</span><br></pre></td></tr></table></figure>
<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">主配置文件</span><br><span class="line">   全局配置: options &#123;&#125;;</span><br><span class="line">   日志子系统配置:<span class="built_in"> logging </span>&#123;&#125;;</span><br><span class="line">   区域定义: 本机能够为哪些zone进行解析，就要定义哪些zone</span><br><span class="line">      zone <span class="string">"ZONE_NAME"</span> <span class="keyword">IN</span> &#123;&#125;;</span><br><span class="line"></span><br><span class="line">注: 任何服务程序如果期望其能够通过网络被其它主机访问，至少应该监听在一个能与</span><br><span class="line">  外部主机通信的IP地址上</span><br><span class="line"></span><br><span class="line">缓存名称服务器的配置</span><br><span class="line">   监听外部地址即可</span><br><span class="line">   dnssec: 建议关闭dnssec，设为<span class="literal">no</span></span><br></pre></td></tr></table></figure>
<hr>
<h1 id="dig命令"><a href="#dig命令" class="headerlink" title="dig命令"></a>dig命令</h1><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">dig</span> [-t <span class="built_in">type</span>] name [@SERVER] [query <span class="keyword">options</span>]</span><br><span class="line">   <span class="keyword">dig</span>只用于测试dns系统，不会查询hosts文件进行解析</span><br><span class="line"></span><br><span class="line">查询选项</span><br><span class="line">   +[<span class="keyword">no</span>]trace: 跟踪解析过程，<span class="keyword">dig</span> +trace xdg.<span class="keyword">com</span></span><br><span class="line">   +[<span class="keyword">no</span>]recurse: 进行递归解析</span><br><span class="line">	测试反向解析:</span><br><span class="line">      <span class="keyword">dig</span> -<span class="keyword">x</span> IP = <span class="keyword">dig</span> –t <span class="keyword">ptr</span> reverseip.in-addr.arpa</span><br><span class="line">	模拟区域传送:</span><br><span class="line">      <span class="keyword">dig</span> -t axfr ZONE_NAME  @SERVER</span><br><span class="line">      <span class="keyword">dig</span> -t axfr magedu.<span class="keyword">com</span>  @<span class="number">10.10</span>.<span class="number">10.11</span></span><br><span class="line">      <span class="keyword">dig</span> –t axfr <span class="number">100.1</span>.<span class="number">10</span>.in-addr.arpa  @<span class="number">172.16</span>.<span class="number">1.1</span></span><br><span class="line">      注: 可以抓取DNS上的取全部信息的数据，如果想禁抓取的话</span><br><span class="line">      注: 指定的某个域才可以（直接读取）</span><br><span class="line">例:</span><br><span class="line">   <span class="keyword">dig</span> -t NS . @<span class="number">114.114</span>.<span class="number">114.114</span>  # 查看所有的根</span><br><span class="line">   <span class="keyword">dig</span> -t NS . @a.root-servers.net</span><br><span class="line"></span><br><span class="line">host [-t <span class="built_in">type</span>] name [SERVER]</span><br><span class="line">   host –t NS  xdg.<span class="keyword">com</span> <span class="number">172.16</span>.<span class="number">0.1</span></span><br><span class="line">   host –t soa xdg.<span class="keyword">com</span></span><br><span class="line">   host –t mx  xdg.<span class="keyword">com</span></span><br><span class="line">   host –t axfr xdg.<span class="keyword">com</span></span><br><span class="line">   host  <span class="number">1.2</span>.<span class="number">3.4</span></span><br></pre></td></tr></table></figure>
<h1 id="nslookup命令"><a href="#nslookup命令" class="headerlink" title="nslookup命令"></a>nslookup命令</h1><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">nslookup [-option] [name | -] [server]</span><br><span class="line">交互式模式</span><br><span class="line">   nslookup&gt;</span><br><span class="line">  <span class="built_in"> server IP </span> # 指明使用哪个DNS server进行查询</span><br><span class="line">   <span class="builtin-name">set</span> <span class="attribute">q</span>=RR_TYPE  # 指明查询的资源记录类型</span><br><span class="line">   NAME  # 要查询的名称</span><br></pre></td></tr></table></figure>
<h1 id="rndc命令"><a href="#rndc命令" class="headerlink" title="rndc命令"></a>rndc命令</h1><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">注:</span> <span class="string">有时会出现问题</span></span><br><span class="line"><span class="string">rndc</span></span><br><span class="line">   <span class="string">rndc</span> <span class="bullet">--&gt;</span> <span class="string">rndc</span> <span class="string">(953/tcp)</span></span><br><span class="line">   <span class="string">rndc</span> <span class="string">COMMAND</span></span><br><span class="line"></span><br><span class="line"><span class="string">COMMAND</span></span><br><span class="line"><span class="attr">   reload:</span> <span class="string">重载主配置文件和区域解析库文件</span></span><br><span class="line">   <span class="string">reload</span> <span class="attr">zonename:</span> <span class="string">重载区域解析库文件</span></span><br><span class="line">   <span class="string">retransfer</span> <span class="attr">zonename:</span> <span class="string">手动启动区域传送，而不管序列号是否增加</span></span><br><span class="line">   <span class="string">notify</span> <span class="attr">zonename:</span> <span class="string">重新对区域传送发通知</span></span><br><span class="line"><span class="attr">   reconfig:</span> <span class="string">重载主配置文件</span></span><br><span class="line"><span class="attr">   querylog:</span> <span class="string">开启或关闭查询日志文件/var/log/message</span></span><br><span class="line"><span class="attr">   trace:</span> <span class="string">递增debug一个级别</span></span><br><span class="line">   <span class="string">trace</span> <span class="attr">LEVEL:</span> <span class="string">指定使用的级别</span></span><br><span class="line"><span class="attr">   notrace:</span> <span class="string">将调试级别设置为</span> <span class="number">0</span></span><br><span class="line"><span class="attr">   flush:</span> <span class="string">清空DNS服务器的所有缓存记录</span></span><br><span class="line"><span class="attr">   status:</span> <span class="string">查看状态</span></span><br></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/DNS/" rel="tag"># DNS</a>
          
            <a href="/tags/Bind/" rel="tag"># Bind</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/04/10/linux/服务/自动化安装系统/cobbler/" rel="next" title="cobbler">
                <i class="fa fa-chevron-left"></i> cobbler
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/11/linux/服务/dns/DNS相关特性/" rel="prev" title="DNS相关特性">
                DNS相关特性 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="XDG" />
          <p class="site-author-name" itemprop="name">XDG</p>
           
              <p class="site-description motion-element" itemprop="description">Personal Blog</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">95</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">82</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/sun-monkeys/xdg/" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/xddggg" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#DNS服务"><span class="nav-number">1.</span> <span class="nav-text">DNS服务</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DNS域名"><span class="nav-number">2.</span> <span class="nav-text">DNS域名</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DNS解析"><span class="nav-number">3.</span> <span class="nav-text">DNS解析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#一次完整的查询请求经过的流程"><span class="nav-number">3.1.</span> <span class="nav-text">一次完整的查询请求经过的流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反向区域"><span class="nav-number">3.2.</span> <span class="nav-text">反向区域</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#DNS服务器类型"><span class="nav-number">4.</span> <span class="nav-text">DNS服务器类型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#区域传输"><span class="nav-number">5.</span> <span class="nav-text">区域传输</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#资源记录"><span class="nav-number">6.</span> <span class="nav-text">资源记录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SOA记录"><span class="nav-number">6.1.</span> <span class="nav-text">SOA记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NS记录"><span class="nav-number">6.2.</span> <span class="nav-text">NS记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MX记录"><span class="nav-number">6.3.</span> <span class="nav-text">MX记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A记录"><span class="nav-number">6.4.</span> <span class="nav-text">A记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#其它记录"><span class="nav-number">6.5.</span> <span class="nav-text">其它记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#别名记录"><span class="nav-number">6.6.</span> <span class="nav-text">别名记录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子域"><span class="nav-number">6.7.</span> <span class="nav-text">子域</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#互联网域名"><span class="nav-number">6.8.</span> <span class="nav-text">互联网域名</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bind"><span class="nav-number">7.</span> <span class="nav-text">Bind</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#bind服务器"><span class="nav-number">7.1.</span> <span class="nav-text">bind服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#配置文件"><span class="nav-number">7.2.</span> <span class="nav-text">配置文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#dig命令"><span class="nav-number">8.</span> <span class="nav-text">dig命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#nslookup命令"><span class="nav-number">9.</span> <span class="nav-text">nslookup命令</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#rndc命令"><span class="nav-number">10.</span> <span class="nav-text">rndc命令</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">XDG</span>
</div>


<div class="powered-by">
   心有猛虎
</div>

<div class="theme-info">
  细嗅蔷薇
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  





  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
